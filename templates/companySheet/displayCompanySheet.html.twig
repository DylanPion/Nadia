{% extends "base.html.twig" %}
{% block title %}
	Détails Fiche Société
{% endblock %}
{% block body %}
	{% include "_sidebar.html.twig" %}

	<div class="CompanyInfos">
		<div class="nav">
			<ul>
				<li class="nav-link">
					<a href="#" class="tablink" onclick="openTab(event,'companyCard')">
						Fiche sté
					</a>
				</li>
				<li class="nav-link">
					<a href="#" class="tablink" onclick="openTab(event, 'requestedCard')">
						Engagement
					</a>
				</li>
				<li class="nav-link">
					<a href="#" class="tablink" onclick="openTab(event, 'payCard')">
						Versement
					</a>
				</li>
			</ul>
		</div>

		<div class="card-container">
			<div class="tabcontent" id="companyCard">
				<div class="card">
					<div>
						<ul>
							<li>{{company.companyName}}</li>
							<li>{{associationName}}</li>
							<li>Année CE :
								{{company.dateOfCe | date (" d/m/y")}}</li>
							<li>
								Statut du prêt :
								{{company.loanstatus}}
							</li>
							{% for name in projectleadername %}
								<li>
									Nom Prénom des porteurs de projets :
									{{name}}</li>
							{% endfor %}
						</ul>
					</div>
					<div>
						<ul>
							<li>Numéro de convention de financement CDC/BPI :
								{{company.Agreement}}</li>
						</ul>
					</div>
				</div>
			</div>

			<div class="tabcontent" id="requestedCard">
				<div class="card">
					<div>
						<ul>
							<li>Montant engagé :
								{{company.fniamountrequested|number_format(0, '.', ' ')}}
								€
							</li>
							<li>Début du début de rembroust :
								{{company.repaymentstartdate | date (" d/m/y")}}
							</li>
						</ul>
					</div>
					<div>
						<ul>
							<li>Date de fin de rembourst :{{company.repaymentenddate | date (" d/m/y")}}
							</li>
						</ul>
					</div>
				</div>
			</div>

			<div class="tabcontent" id="payCard">
				<div class="card">
					<div>
						<ul>
							<li>Date du 1er verst :
								{{company.paymentonedate | date (" d/m/y")}}
							</li>
							<li>Date du 2nd verst :
								{{company.paymenttwodate | date (" d/m/Y") }}
							</li>
							<li>Reste à versé :
								{{(company.fniamountrequested - company.paymentone - company.paymenttwo)|number_format(0, '.', ' ')}}

								€
							</li>
						</ul>
					</div>
					<div>
						<ul>
							<li>Montant du verst 1 :
								{{company.paymentone|number_format(0, '.', ' ')}}
								€
							</li>
							<li>Montant du verst 2 :
								{{company.paymenttwo|number_format(0, '.', ' ')}}
								€
							</li>

							<li>Total versé :
								{{(company.paymentone + company.paymenttwo)|number_format(0, '.', ' ')}}
								€
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="tableTotalAmountRepaid">
		<table class="table-content">
			<caption>TABLEAU DE SUIVI DES REMBOURSEMENTS :</caption>
			<thead>
				<tr>
					<th>Montant Engagé :
						{{company.fniamountrequested|number_format(0, '.', ' ')}}
						€
					</th>
					<th>Total Reçu :
						{{totalPaymentReceived|number_format(0, '.', ' ')}}
						€
					</th>
					<th>Reste à Reçevoir :
						{{(company.fniamountrequested - totalPaymentReceived)|number_format(0, '.', ' ')}}
						€
					</th>
					<th></th>
				</tr>
				<tr>
					<th>Total Remboursé à ce jour</th>
					<th>Date des rembrts
					</th>
					<th>Montant Reçus</th>
					<th></th>
				</tr>
			</thead>

			<tbody>
				<tr>
					{{form_start(formView)}}
					<td>{{form_row(formView.totalAmountRepaidToDate)}}</td>
					<td>{{form_row(formView.Date)}}</td>
					<td>{{form_row(formView.Payment) }}</td>
					<td>{{form_row(formView.Button)}}</td>
					{{form_end(formView)}}
				</tr>
				{% for total in totalAmountRepaid %}
					<tr>
						<td>{{total.TotalAmountRepaidToDate}}</td>
						<td>{{total.Date| date ("d/m/Y")}}</td>
						<td>{{total.Payment ?? "0"}}</td>
						<td>
							<a href="{{ path('app_account_edit', {id: total.id}) }}" class="edit">
								<i class="fa-solid fa-pen-to-square"></i>
								<span>Éditer</span>
							</a>
							<a href="{{ path('app_account_delete', {id: total.id}) }}" class="delete">
								<i class="fa-sharp fa-solid fa-trash-can"></i>
								<span>Supprimer</span>
							</a>
						</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
{% endblock %}
